using System.Text;

namespace SA2MessageTextTool
{
    public static class TextConversion
    {
        public static string ToString(byte[] bytes)
        {
            var name = new StringBuilder();

            foreach (var b in bytes)
            {
                if (b == 0) break;

                if (CharTable.ContainsKey(b))
                    name.Append(CharTable[b]);
                else
                    name.Append($"{{{b}}}");
            }

            return name.ToString();
        }

        public static byte[] ToBytes(string line)
        {
            var bytes = new List<byte>();
            var reversedCharTable = CharTable.ToDictionary(x => x.Value, y => y.Key);

            foreach (var c in line)
            {
                if (reversedCharTable.ContainsKey(c))
                    bytes.Add(reversedCharTable[c]);
            }

            return bytes.ToArray();
        }


        public static Dictionary<byte, char> CharTable = new Dictionary<byte, char>()
        {
            // ASCII
            
            { 1, '!' },
            { 2, '\"' },
            { 3, '#' },
            { 4, '$' },
            { 5, '%' },
            { 6, '&' },
            { 7, '\'' },
            { 8, '(' },
            { 9, ')' },
            { 10, '*' },
            { 11, '+' },
            { 12, ',' },
            { 13, '-' },
            { 14, '.' },
            { 15, '/' },
            { 16, '0' },
            { 17, '1' },
            { 18, '2' },
            { 19, '3' },
            { 20, '4' },
            { 21, '5' },
            { 22, '6' },
            { 23, '7' },
            { 24, '8' },
            { 25, '9' },
            { 26, ':' },
            { 27, ';' },
            { 28, '<' },
            { 29, '=' },
            { 30, '>' },
            { 31, '?' },
            { 32, '@' },
            { 33, 'A' },
            { 34, 'B' },
            { 35, 'C' },
            { 36, 'D' },
            { 37, 'E' },
            { 38, 'F' },
            { 39, 'G' },
            { 40, 'H' },
            { 41, 'I' },
            { 42, 'J' },
            { 43, 'K' },
            { 44, 'L' },
            { 45, 'M' },
            { 46, 'N' },
            { 47, 'O' },
            { 48, 'P' },
            { 49, 'Q' },
            { 50, 'R' },
            { 51, 'S' },
            { 52, 'T' },
            { 53, 'U' },
            { 54, 'V' },
            { 55, 'W' },
            { 56, 'X' },
            { 57, 'Y' },
            { 58, 'Z' },
            { 59, '[' },
            { 60, '¥' },
            { 61, ']' },
            { 62, '^' },
            { 63, '_' },
            { 64, '`' },
            { 65, 'a' },
            { 66, 'b' },
            { 67, 'c' },
            { 68, 'd' },
            { 69, 'e' },
            { 70, 'f' },
            { 71, 'g' },
            { 72, 'h' },
            { 73, 'i' },
            { 74, 'j' },
            { 75, 'k' },
            { 76, 'l' },
            { 77, 'm' },
            { 78, 'n' },
            { 79, 'o' },
            { 80, 'p' },
            { 81, 'q' },
            { 82, 'r' },
            { 83, 's' },
            { 84, 't' },
            { 85, 'u' },
            { 86, 'v' },
            { 87, 'w' },
            { 88, 'x' },
            { 89, 'y' },
            { 90, 'z' },
            { 91, '{' },
            { 92, '|' },
            { 93, '}' },
            { 94, '~' },

            // Cyrillic (replaces extended CP1252 latin characters)

            { 96, 'А' },
            { 97, 'Б' },
            { 98, 'В' },
            { 99, 'Г' },
            { 100, 'Д' },
            { 101, 'Е' },
            { 102, 'Ж' },
            { 103, 'З' },
            { 104, 'И' },
            { 105, 'Й' },
            { 106, 'К' },
            { 107, 'Л' },
            { 108, 'М' },
            { 109, 'Н' },
            { 110, 'О' },
            { 111, 'П' },
            { 112, 'Р' },
            { 113, 'С' },
            { 114, 'Т' },
            { 115, 'У' },
            { 116, 'Ф' },
            { 117, 'Х' },
            { 118, 'Ц' },
            { 119, 'Ч' },
            { 120, 'Ш' },
            { 121, 'Щ' },
            { 122, 'Ъ' },
            { 123, 'Ы' },
            { 124, 'Ь' },
            { 125, 'Э' },
            { 126, 'Ю' },
            { 127, 'Я' },
            { 128, 'а' },
            { 129, 'б' },
            { 130, 'в' },
            { 131, 'г' },
            { 132, 'д' },
            { 133, 'е' },
            { 134, 'ж' },
            { 135, 'з' },
            { 136, 'и' },
            { 137, 'й' },
            { 138, 'к' },
            { 139, 'л' },
            { 140, 'м' },
            { 141, 'н' },
            { 142, 'о' },
            { 143, 'п' },
            { 144, 'р' },
            { 145, 'с' },
            { 146, 'т' },
            { 147, 'у' },
            { 148, 'ф' },
            { 149, 'х' },
            { 150, 'ц' },
            { 151, 'ч' },
            { 152, 'ш' },
            { 153, 'щ' },
            { 154, 'ъ' },
            { 155, 'ы' },
            { 156, 'ь' },
            { 157, 'э' },
            { 158, 'ю' },
            { 159, 'я' },

            // Japanese

            { 160, 'ァ' },
            { 161, 'ア' },
            { 162, 'ィ' },
            { 163, 'イ' },
            { 164, 'ゥ' },
            { 165, 'ウ' },
            { 166, 'ェ' },
            { 167, 'エ' },
            { 168, 'ォ' },
            { 169, 'オ' },
            { 170, 'カ' },
            { 171, 'ガ' },
            { 172, 'キ' },
            { 173, 'ギ' },
            { 174, 'ク' },
            { 175, 'グ' },
            { 176, 'ケ' },
            { 177, 'ゲ' },
            { 178, 'コ' },
            { 179, 'ゴ' },
            { 180, 'サ' },
            { 181, 'ザ' },
            { 182, 'シ' },
            { 183, 'ジ' },
            { 184, 'ス' },
            { 185, 'ズ' },
            { 186, 'セ' },
            { 187, 'ゼ' },
            { 188, 'ソ' },
            { 189, 'ゾ' },
            { 190, 'タ' },
            { 191, 'ダ' },
            { 192, 'チ' },
            { 193, 'ヂ' },
            { 194, 'ツ' },
            { 195, 'ッ' },
            { 196, 'ヅ' },
            { 197, 'テ' },
            { 198, 'デ' },
            { 199, 'ト' },
            { 200, 'ド' },
            { 201, 'ナ' },
            { 202, 'ニ' },
            { 203, 'ヌ' },
            { 204, 'ネ' },
            { 205, 'ノ' },
            { 206, 'ハ' },
            { 207, 'バ' },
            { 208, 'パ' },
            { 209, 'ヒ' },
            { 210, 'ビ' },
            { 211, 'ピ' },
            { 212, 'フ' },
            { 213, 'ブ' },
            { 214, 'プ' },
            { 215, 'ヘ' },
            { 216, 'ベ' },
            { 217, 'ぺ' },
            { 218, 'ホ' },
            { 219, 'ボ' },
            { 220, 'ポ' },
            { 221, 'マ' },
            { 222, 'ミ' },
            { 223, 'ム' },
            { 224, 'メ' },
            { 225, 'モ' },
            { 226, 'ャ' },
            { 227, 'ヤ' },
            { 228, 'ュ' },
            { 229, 'ユ' },
            { 230, 'ョ' },
            { 231, 'ヨ' },
            { 232, 'ラ' },
            { 233, 'リ' },
            { 234, 'ル' },
            { 235, 'レ' },
            { 236, 'ロ' },
            { 237, 'ヮ' },
            { 238, 'ワ' },
            { 241, 'ヲ' },
            { 242, 'ン' },
            { 243, '。' },
            { 244, '、' },
            { 245, '〒' },
            { 246, '・' },
            { 247, '★' },
            { 248, '♀' },
            { 249, '♂' },
            { 250, '♪' },
            { 251, '…' },
            { 252, '「' },
            { 253, '」' },
            { 254, 'ヴ' },
        };
    }
}
